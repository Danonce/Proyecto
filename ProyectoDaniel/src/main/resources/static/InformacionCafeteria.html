<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CafeStars - Información Cafetería</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .header {
            background-color: #8B4513;
            color: white;
            text-align: center;
            padding: 20px;
        }
        .header h1 a {
            color: white;
            text-decoration: none;
        }
        .nav {
            display: flex;
            justify-content: center;
            background-color: #8B4513;
            padding: 10px;
        }
        .nav a {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            font-size: 1.1em;
        }
        .nav a:hover {
            color: #FFD700; /* Dorado */
            border-bottom: 2px solid #FFD700;
        }
        .detailed-view {
            padding: 20px;
            background-color: white;
            max-width: 600px;
            margin: auto;
        }
        .carrusel {
            position: relative;
            margin-bottom: 20px;
        }
        .carrusel img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            display: none;
        }
        .carrusel img.active {
            display: block;
        }
        .carrusel button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            font-size: 2em;
            padding: 0 10px;
            cursor: pointer;
            border-radius: 3px;
            user-select: none;
        }
        #prev {
            left: 10px;
        }
        #next {
            right: 10px;
        }
        .detailed-view h2 {
            margin: 10px 0;
            font-size: 1.5em;
        }
        .detailed-view p {
            margin: 5px 0;
            color: #666;
        }
        .review {
            background-color: #f4f4f4;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
        }
        .review p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1><a href="Inicio.html">CafeStars</a></h1>
    </div>

    <div class="nav">
        <a href="Buscador.html">Explorar cafeterías</a>
        <a href="#">Pedidos</a>
        <a href="#">Reseñas</a>
    </div>

    <div class="detailed-view">
        <h2></h2>
        <p class="menu"></p>
        <p class="ubicacion"></p>
        <p class="horario"></p>

        <div class="carrusel">
            <button id="prev" aria-label="Imagen anterior">‹</button>
            <button id="next" aria-label="Imagen siguiente">›</button>
        </div>

        <h3>Reseñas</h3>
        <div class="resenas"></div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');

        fetch(`http://localhost:80/cafeterias/${id}`)
            .then(response => response.json())
            .then(data => {
                const cafe = data.cafeteria;
                const resenas = data.resenas;

                document.querySelector('h2').innerText = cafe.nombreCafeteria;
                document.querySelector('.menu').innerText = 'Menú: ' + cafe.menu;
                document.querySelector('.ubicacion').innerText = 'Ubicación: ' + cafe.ubicacion;
                document.querySelector('.horario').innerText = 'Horario: ' + cafe.horario;

                // Insertar imágenes en carrusel
                const carrusel = document.querySelector('.carrusel');
                const imagenesHtml = [1, 2, 3].map(i =>
                    `<img src="../imgCafeterias/${id}/${i}.jpg" alt="Imagen ${i}">`
                ).join('');
                // Insertar antes de los botones
                carrusel.insertAdjacentHTML('afterbegin', imagenesHtml);

                const imgs = carrusel.querySelectorAll('img');
                let indiceActual = 0;

                function mostrarImagen(indice) {
                    imgs.forEach((img, i) => {
                        img.classList.toggle('active', i === indice);
                    });
                }

                mostrarImagen(indiceActual);

                document.getElementById('prev').addEventListener('click', () => {
                    indiceActual = (indiceActual - 1 + imgs.length) % imgs.length;
                    mostrarImagen(indiceActual);
                });

                document.getElementById('next').addEventListener('click', () => {
                    indiceActual = (indiceActual + 1) % imgs.length;
                    mostrarImagen(indiceActual);
                });

                // Mostrar reseñas
                const resenasHtml = resenas.map(r => `
                    <div class="review">
                        <p>Calificación: ${r.calificacion}/10</p>
                        <p><strong>${r.nombre}</strong> - ${r.comentario}</p>
                    </div>
                `).join('');
                document.querySelector('.resenas').innerHTML = resenasHtml;
            })
            .catch(error => {
                console.error('Error al cargar la cafetería:', error);
            });
    </script>
</body>
</html>

